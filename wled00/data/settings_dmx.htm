<!DOCTYPE html>
<html lang="en">
<head>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
	<meta charset="utf-8">
	<title>DMX 设置</title>
	<script src="common.js" type="text/javascript"></script>
	<script>
	function HW(){window.open("https://kno.wled.ge/interfaces/dmx-output/");}
	function GCH(num) {
		gId('dmxchannels').innerHTML += "";
		for (i=0;i<num;i++) {
			gId('dmxchannels').innerHTML += "<span id=CH" + (i+1) + "s >通道 " + (i+1) + ": <select name=CH" + (i+1) + " id=\"CH" + (i+1) + "\"><option value=0>设置为0</option><option value=1>红色</option><option value=2>绿色</option><option value=3>蓝色</option><option value=4>白色</option><option value=5>快门(亮度)</option><option value=6>设置为255</option></select></span><br />\n";
		}
	}
	function mMap(){
		numCh=document.Sf.CN.value;
		numGap=document.Sf.CG.value;
		if (parseInt(numCh)>parseInt(numGap)) {
			gId("gapwarning").style.display="block";
		} else {
			gId("gapwarning").style.display="none";
		}
		for (i=0;i<15;i++) {
			if (i>=numCh) {
				gId("CH"+(i+1) + "s").style.opacity = "0.5";
				gId("CH"+(i+1)).disabled = true;
				
			} else {
				gId("CH"+(i+1) + "s").style.opacity = "1";
				gId("CH"+(i+1)).disabled = false;
			}
		}
	}
	function S(){
		getLoc();
		// 初始化语言切换按钮
		initLangToggle();
		// 应用翻译
		applyTranslations();
		loadJS(getURL('/settings/s.js?p=7'), false, ()=>{GCH(15);}, ()=>{mMap();}); // If we set async false, file is loaded and executed, then next statement is processed
		if (loc) d.Sf.action = getURL('/settings/dmx');
	}
	</script>
	<style>@import url("style.css");</style>
</head>
<body onload="S()">
<form id="form_s" name="Sf" method="post">
<div class="toprow">
<div class="helpB"><button type="button" onclick="HW()">?</button></div>
	<button type="button" onclick="B()" data-i18n="back">返回</button><button type="submit" data-i18n="save">保存</button>
	<button type="button" id="langToggle" onclick="toggleLanguage()" style="background: rgba(255,255,255,0.1); border: none; color: var(--c-t); padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 11px; margin-left: 8px;">EN</button>
	<hr>
	</div>
	<h2 data-i18n="dmxOutput">DMX 输出设置</h2>

代理宇宙 <input name=PU type=number min=0 max=63999 required> 从 E1.31 到 DMX (0=禁用)<br>
<i>这将禁用下面可配置的LED数据输出到DMX</i><br><br>
<i>灯具数量从LED配置页面获取</i><br>

每个灯具的通道数 (最多15): <input type="number" min="1" max="15" name="CN" maxlength="2" onchange="mMap();"><br />
起始通道: <input type="number" min="1" max="512" name="CS" maxlength="2"><br />
起始通道之间的间距: <input type="number" min="1" max="512" name="CG" maxlength="2" onchange="mMap();"> [ <a href="javascript:alert('如果设置为10，第一个灯具将从10开始，\n第二个将从20开始，依此类推。\n无论通道数如何。\n使记忆通道号更容易。');">信息</a> ]<br>
<div id="gapwarning" style="color: orange; display: none;">警告: 通道间距小于每个灯具的通道数。<br />这将导致重叠。</div>
<button type="button" onclick="location.href='/dmxmap';">DMX 映射</button><br>
DMX灯具起始LED: <input type="number" min="0" max="1500" name="SL">
<h3>通道功能</h3>
<div id="dmxchannels"></div>
<hr><button type="button" onclick="B()">返回</button><button type="submit">保存</button>
</form>
</body>
</html>
